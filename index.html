<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Keep your existing head section -->
    <!-- Add this script at the bottom of the body -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const form = document.getElementById('uploadForm');
            const fileInput = document.getElementById('fileInput');
            const fileLabel = document.querySelector('label[for="fileInput"] p');
            
            // Update file name display
            fileInput.addEventListener('change', function() {
                if (this.files.length > 0) {
                    fileLabel.textContent = this.files[0].name;
                }
            });
            
            // Handle form submission with fetch
            form.addEventListener('submit', async function(e) {
                e.preventDefault();
                
                const formData = new FormData();
                formData.append('file', fileInput.files[0]);
                
                try {
                    const response = await fetch('https://a0b3-202-47-44-217.ngrok-free.app/upload', {
                        method: 'POST',
                        body: formData,
                        mode: 'cors'
                    });
                    
                    const data = await response.json();
                    
                    if (data.success) {
                        // Update UI with response data
                        window.location.href = `speech.html?audio=${encodeURIComponent(data.audio_url)}&filename=${encodeURIComponent(data.filename)}&time=${data.processing_time}`;
                    } else {
                        showError(data.error || 'Processing failed');
                    }
                } catch (error) {
                    showError('Failed to connect to server');
                }
            });
            
            function showError(message) {
                const errorDiv = document.createElement('div');
                errorDiv.className = 'error';
                errorDiv.innerHTML = `
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 10px;">
                        <circle cx="12" cy="12" r="10"></circle>
                        <line x1="12" y1="8" x2="12" y2="12"></line>
                        <line x1="12" y1="16" x2="12.01" y2="16"></line>
                    </svg>
                    ${message}
                `;
                document.querySelector('.container').appendChild(errorDiv);
            }
        });
    </script>
</head>
<body>
    <!-- Keep your existing body content -->
</body>
</html>
